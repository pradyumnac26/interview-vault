{"version":3,"sources":["../src/composables/useClerkContext.ts","../src/keys.ts","../src/composables/useClerk.ts","../src/composables/useAuth.ts","../src/errors/messages.ts","../src/utils/childrenUtils.ts","../src/utils/toComputedRefs.ts","unplugin-vue:\u0000/plugin-vue/export-helper"],"sourcesContent":["import { inject } from 'vue';\n\nimport { errorThrower } from '../errors/errorThrower';\nimport { ClerkInjectionKey } from '../keys';\n\nexport function useClerkContext(source: string) {\n  const ctx = inject(ClerkInjectionKey);\n\n  if (!ctx) {\n    return errorThrower.throw(\n      `${source} can only be used when the Vue plugin is installed. Learn more: https://clerk.com/docs/reference/vue/clerk-plugin`,\n    );\n  }\n\n  return ctx;\n}\n","import type { InjectionKey } from 'vue';\n\nimport type { AddCustomMenuItemParams, AddCustomPagesParams, VueClerkInjectionKeyType } from './types';\n\nexport const ClerkInjectionKey = Symbol('clerk') as InjectionKey<VueClerkInjectionKeyType>;\n\nexport const UserButtonInjectionKey = Symbol('UserButton') as InjectionKey<{\n  addCustomMenuItem(params: AddCustomMenuItemParams): void;\n}>;\n\nexport const UserButtonMenuItemsInjectionKey = Symbol('UserButton.MenuItems') as InjectionKey<{\n  addCustomMenuItem(params: AddCustomMenuItemParams): void;\n}>;\n\nexport const UserProfileInjectionKey = Symbol('UserProfile') as InjectionKey<{\n  addCustomPage(params: AddCustomPagesParams): void;\n}>;\n\nexport const OrganizationProfileInjectionKey = Symbol('OrganizationProfile') as InjectionKey<{\n  addCustomPage(params: AddCustomPagesParams): void;\n}>;\n","import { useClerkContext } from './useClerkContext';\n\n/**\n * Returns the [`Clerk`](https://clerk.com/docs/reference/javascript/clerk/clerk) instance which provides\n * low-level access to Clerk's functionality, enabling custom authentication UI and flows.\n *\n * @example\n * <script setup>\n * import { useClerk } from '@clerk/vue'\n *\n * const clerk = useClerk()\n *\n * const openSignIn = () => clerk.value.openSignIn()\n * </script>\n *\n * <template>\n *   <button @click=\"openSignIn\">Sign in</button>\n * </template>\n */\nexport const useClerk = () => {\n  const { clerk } = useClerkContext('useClerk');\n\n  return clerk;\n};\n","import { createCheckAuthorization, resolveAuthState } from '@clerk/shared/authorization';\nimport type { Clerk, GetToken, JwtPayload, PendingSessionOptions, SignOut, UseAuthReturn } from '@clerk/shared/types';\nimport { computed, type ShallowRef, watch } from 'vue';\n\nimport { errorThrower } from '../errors/errorThrower';\nimport { invalidStateError } from '../errors/messages';\nimport type { ToComputedRefs } from '../utils';\nimport { toComputedRefs } from '../utils';\nimport { useClerkContext } from './useClerkContext';\n\n/**\n * @internal\n */\nfunction clerkLoaded(clerk: ShallowRef<Clerk | null>) {\n  return new Promise<Clerk>(resolve => {\n    watch(\n      clerk,\n      value => {\n        if (value?.loaded) {\n          resolve(value);\n        }\n      },\n      { immediate: true },\n    );\n  });\n}\n\n/**\n * @internal\n */\nfunction createGetToken(clerk: ShallowRef<Clerk | null>) {\n  return async (options: any) => {\n    const loadedClerk = await clerkLoaded(clerk);\n    if (!loadedClerk.session) {\n      return null;\n    }\n\n    return loadedClerk.session.getToken(options);\n  };\n}\n\n/**\n * @internal\n */\nfunction createSignOut(clerk: ShallowRef<Clerk | null>) {\n  return async (...args: any) => {\n    const loadedClerk = await clerkLoaded(clerk);\n    return loadedClerk.signOut(...args);\n  };\n}\n\ntype UseAuth = (options?: PendingSessionOptions) => ToComputedRefs<UseAuthReturn>;\n\n/**\n * Returns the current auth state, the user and session ids and the `getToken`\n * that can be used to retrieve the given template or the default Clerk token.\n *\n * Until Clerk loads, `isLoaded` will be set to `false`.\n * Once Clerk loads, `isLoaded` will be set to `true`, and you can\n * safely access the `userId` and `sessionId` variables.\n *\n * @example\n * <script setup>\n * import { useAuth } from '@clerk/vue'\n *\n * const { isSignedIn, sessionId, userId } = useAuth()\n * </script>\n *\n * <template>\n *   <div v-if=\"isSignedIn\">\n *     <!-- {{ sessionId }} {{ userId }} -->\n *     ...\n *   </div>\n * </template>\n */\nexport const useAuth: UseAuth = (options = {}) => {\n  const { clerk, authCtx } = useClerkContext('useAuth');\n\n  const getToken: GetToken = createGetToken(clerk);\n  const signOut: SignOut = createSignOut(clerk);\n\n  const result = computed<UseAuthReturn>(() => {\n    const { userId, orgId, orgRole, orgPermissions, sessionClaims, factorVerificationAge } = authCtx.value;\n\n    const has = createCheckAuthorization({\n      userId,\n      orgId,\n      orgRole,\n      orgPermissions,\n      factorVerificationAge,\n      features: ((sessionClaims as JwtPayload | undefined)?.fea as string) || '',\n      plans: ((sessionClaims as JwtPayload | undefined)?.pla as string) || '',\n    });\n\n    const payload = resolveAuthState({\n      authObject: {\n        ...authCtx.value,\n        getToken,\n        signOut,\n        has,\n      },\n      options: {\n        treatPendingAsSignedOut: options.treatPendingAsSignedOut,\n      },\n    });\n\n    if (!payload) {\n      return errorThrower.throw(invalidStateError);\n    }\n\n    return payload;\n  });\n\n  return toComputedRefs(result);\n};\n","export const multipleChildrenInButtonComponent = (name: string) =>\n  `You've passed multiple children components to <${name}/>. You can only pass a single child component or text.`;\n\nexport const invalidStateError =\n  'Invalid state. Feel free to submit a bug or reach out to support here: https://clerk.com/support';\n\nexport const useAuthHasRequiresRoleOrPermission =\n  'Missing parameters. `has` from `useAuth` requires a permission or role key to be passed. Example usage: `has({permission: \"org:posts:edit\"})`';\n\nexport const userButtonMenuActionRenderedError =\n  '<UserButton.Action /> component needs to be a direct child of `<UserButton.MenuItems />`.';\n\nexport const userButtonMenuLinkRenderedError =\n  '<UserButton.Link /> component needs to be a direct child of `<UserButton.MenuItems />`.';\n\nexport const userButtonMenuItemLinkWrongProps =\n  'Missing requirements. <UserButton.Link /> component requires props: href, label and slots: labelIcon.';\n\nexport const userButtonMenuItemActionWrongProps =\n  'Missing requirements. <UserButton.Action /> component requires props: label and slots: labelIcon.';\n\nexport const userButtonMenuItemsRenderedError =\n  '<UserButton.MenuItems /> component needs to be a direct child of `<UserButton />`.';\n\nexport const customPageWrongProps = (componentName: string) =>\n  `Missing requirements. <${componentName}.Page /> component requires props: url, label and slots: labelIcon and a default slot for page content`;\n\nexport const customLinkWrongProps = (componentName: string) =>\n  `Missing requirements. <${componentName}.Link /> component requires the following props: url, label and slots: labelIcon.`;\n\nexport const userProfilePageRenderedError =\n  '<UserProfile.Page /> component needs to be a direct child of `<UserProfile />` or `<UserButton />`.';\nexport const userProfileLinkRenderedError =\n  '<UserProfile.Link /> component needs to be a direct child of `<UserProfile />` or `<UserButton />`.';\n\nexport const organizationProfilePageRenderedError =\n  '<OrganizationProfile.Page /> component needs to be a direct child of `<OrganizationProfile />` or `<OrganizationSwitcher />`.';\nexport const organizationProfileLinkRenderedError =\n  '<OrganizationProfile.Link /> component needs to be a direct child of `<OrganizationProfile />` or `<OrganizationSwitcher />`.';\n","import { h, Text, type VNode } from 'vue';\n\nimport { errorThrower } from '../errors/errorThrower';\nimport { multipleChildrenInButtonComponent } from '../errors/messages';\n\ntype ButtonName =\n  | 'SignInButton'\n  | 'SignUpButton'\n  | 'SignOutButton'\n  | 'SignInWithMetamaskButton'\n  | 'SubscriptionDetailsButton'\n  | 'CheckoutButton'\n  | 'PlanDetailsButton';\n\nexport const normalizeWithDefaultValue = (slotContent: VNode[] | undefined, defaultValue: string) => {\n  // Render a button with the default value if no slot content is provided\n  if (!slotContent) {\n    return h('button', defaultValue);\n  }\n\n  // Render a button with the slot content if it's a text node\n  if (slotContent[0].type === Text) {\n    return h('button', slotContent);\n  }\n\n  // Render the slot content as is\n  return slotContent;\n};\n\nexport const assertSingleChild = (slotContent: VNode | VNode[], name: ButtonName) => {\n  if (Array.isArray(slotContent)) {\n    if (slotContent.length > 1) {\n      return errorThrower.throw(multipleChildrenInButtonComponent(name));\n    }\n    return slotContent[0];\n  }\n\n  return slotContent;\n};\n","import { computed, type ComputedRef } from 'vue';\n\nexport type ToComputedRefs<T = any> = {\n  [K in keyof T]: ComputedRef<T[K]>;\n};\n\n/**\n * Converts a computed ref to an object of computed refs.\n * This will allow the composables to be destructurable and still maintain reactivity.\n */\nexport function toComputedRefs<T extends object>(objectRef: ComputedRef<T>): ToComputedRefs<T> {\n  const result = {} as any;\n\n  for (const key in objectRef.value) {\n    result[key] = computed(() => objectRef.value[key]);\n  }\n\n  return result;\n}\n","\nexport default (sfc, props) => {\n  const target = sfc.__vccOpts || sfc;\n  for (const [key, val] of props) {\n    target[key] = val;\n  }\n  return target;\n}\n"],"mappings":"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","names":["computed","computed"]}